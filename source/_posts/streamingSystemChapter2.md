---
title: 《Streaming System》-第二章： 数据处理的什么、何地、何时以及如何进行
date: 2000-03-17 22:07:43
tags: 
  - Streaming System
categories: 
  - Streaming System
---

<p></p>
<!-- more -->

## 目录
<!-- toc -->

# **路线图**

为了帮助为本章打下基础，我想提出五个主要概念，这些概念将支撑所有讨论，以及大部分第一部分的内容。我们已经讨论了其中两个。

在第一章中，我首先建立了事件时间（事件发生的时间）和处理时间（在处理期间观察到的时间）之间的关键区别。这为本书提出的一个主要论点奠定了基础：如果您关心正确性和事件实际发生的上下文，则必须相对于它们固有的事件时间而不是在分析过程中遇到它们的处理时间来分析数据。

然后，我介绍了*窗口化*的概念（即沿着时间边界对数据集进行分区），这是一种常用的方法，用于应对无限数据源在技术上可能永远不会结束的事实。窗口化策略的一些更简单的例子是*固定*和*滑动*窗口，但更复杂的窗口化类型，例如*会话*（其中窗口是由数据本身的特征定义的;例如，捕获用户的每个活动会话，然后是不活动的间隙），也广泛使用。

除了这两个概念之外，我们现在将仔细研究另外三个概念：

- 触发器 Triggers

  触发器是用于声明与某些外部信号相对应的窗口输出应该实现的机制。触发器提供了选择何时发出输出的灵活性。在某种意义上，您可以将它们视为用于指示何时应该实现结果的流量控制机制。另一种看待它的方式是，触发器就像相机的快门释放，允许您在计算结果的时间中声明何时拍摄时间快照。

  触发器还使得可以多次观察窗口输出随着时间的推移而演变。这反过来打开了随着时间推移细化结果的大门，这允许在数据到达时提供推测结果，以及处理上游数据（修订）随着时间或到达晚（例如，在离线时手机记录各种操作及其事件时间，然后在重获连接时上传这些事件以进行处理）。

- 水印 Watermarks

  水印是相对于事件时间的输入完整性的概念。具有时间 *X* 值的水印表明：“事件时间小于*X*的所有输入数据都已被观察到。”因此，水印在观察没有已知结束的无限数据源时作为进度的指标。我们在本章中介绍了水印的基础知识，然后Slava在第3章中深入探讨了这个主题。

- 累积 Accumulation

  累积模式指定了观察到同一窗口的多个结果之间的关系。这些结果可能完全分离;也就是说，代表随时间独立的增量，或者它们之间可能存在重叠。不同的累积模式具有不同的语义和相关成本，因此在各种用例中找到了应用。

此外，因为我认为这使得更容易理解所有这些概念之间的关系，我们重新审视了旧的并在回答四个问题的结构内探索了新的，我提出这些问题对于每个无限数据处理问题都至关重要：

- 计算出什么结果？这个问题由管道内的转换类型回答。这包括像计算总和、构建直方图、训练机器学习模型等内容。它基本上也是*批处理的常见问题回答的问题*。
- 在什么事件时间计算结果？这个问题由管道内的事件时间窗口化回答。这包括第1章中的常见窗口化示例（固定、滑动和会话），似乎没有窗口化概念的用例（例如，时间不受限制的处理；经典批处理也通常属于此类别）以及其他更复杂的窗口化类型，例如时间限制的拍卖。还要注意，如果将记录的入口时间分配为到达系统时的事件时间，则也可以包括处理时间窗口化。
- 何时在处理时间中实现结果？这个问题是通过触发器和（可选的）水印来回答的。对此主题有无限变化，但最常见的模式是涉及重复更新的模式（即，实现视图语义），利用水印为每个窗口提供单个输出，仅在相应的输入被认为是完整的后才提供（即，应用于每个窗口的经典批处理语义），或两者的某种组合。
- 如何处理结果的细化？这个问题是由使用的累积类型回答的：丢弃（其中结果是所有独立和独特的），累积（其中后来的结果建立在先前的结果之上），或累积和撤回（其中发出累积值加上先前触发的值的撤回）。

我们在本书的其余部分中更详细地研究了这些问题。是的，我将尝试将这个颜色方案运用到底，以尝试清晰地表明哪些概念与*What/Where/When/How*习语中的哪些问题有关系。你是受欢迎的 ` <winky smiley/>`。 
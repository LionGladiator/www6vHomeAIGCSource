---
title: 全局二级索引-GSI
date: 2023-06-05 14:50:16
tags:
  - 数据库
categories:
  - 数据库  
  - 二级索引
---

<p></p>
<!-- more -->

## 目录
<!-- toc -->

## 场景
[Claude]
分布式数据库的全局二级索引主要有以下几个使用场景:
    **加速多表关联查询**:用全局二级索引构建外键索引,可以有效地加速涉及多表关联的查询。
    全表扫描查询:当需要做全表扫描时,使用全局二级索引可以跳过不需要的行,大幅降低扫描成本。
    频繁查询的列上:对于数据库中经常需要根据某列进行查询的情况,建立该列的全局二级索引,可以大幅提高查询效率。
    **需要排序的查询**:当需要查询结果按某个列排序时,全局二级索引可以加速排序。
    模糊查询优化:通过部分键值匹配,全局二级索引可以优化like查询等模式查询。
    **分页查询优化**:结合 Cursor 标记,全局二级索引可以有效的支持分页查询。

总的来说,对于需要高效查询、排序、混合查询等复杂查询的分布式数据库而言,引入全局二级索引可以大大提高性能。尤其是处理大规模数据时,二级索引发挥的作用更加明显。

+ 全局二级索引能够解决什么问题
如果查询的维度与逻辑表的拆分维度不同，会**产生跨分片查询**。跨分片查询的增加会导致查询卡慢、连接池耗尽等性能问题。**GSI**能够通过增加拆分维度来**减少跨分片查询，消除性能瓶颈**。

## 全局索引 vs 局部索引 [1][2]
+ 全局二级索引 [DDIA  基于关键词的二级索引分区]
  数据行和对应的索引行保存在不同分片上
  
+ 局部索引  [DDIA  基于文档的二级索引分区] 
  如果数据行和对应的索引行保存在相同分片上

## 全局索引
+ PolarDB-X [1]
  - XA多写，保证主表与索引表数据强一致。[性能会不会慢]
  - Online Schema Change，添加GSI不锁主表。

## 参考
1. [全局二级索引](https://help.aliyun.com/document_detail/182179.html)  
2. [设计数据密集型应用-C6-分区和二级索引](https://zhuanlan.zhihu.com/p/384439886)  DDIA

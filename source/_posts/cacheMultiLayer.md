---
title: 多级缓存(cache)
date: 2019-05-25 14:08:00
tags:
  - 缓存
categories:
  - 中间件  
  - 缓存
---

<p></p>
<!-- more -->

# 多级缓存 [5?]
### 二级缓存 
+ 二级缓存（本地缓存+远程缓存）
	- 远端Cache推全量或者部分的数据到本地cache，并设置过期时间【初始化】
	- 查询流程
		- 先从本地缓存拿，如果有数据且有效，就直接返回
		- 如果没有命中
			- 1.本地查询远端服务，并拿到结果
			- 2.本地更新远端缓存
			- 3.更新本地缓存
	- 本地cache失效+更新流程,本地防穿透【1】
		- 同步更新缓存
			- 访问同一个key的业务线程只有一个线程穿透到远端Cache，其他线程等待穿透线程的返回结果[加锁]
		- 异步更新缓存
			- 1.过期时间到了后，产生过期事件，延长数据有效期，返回旧的数据
			- 2. 检查过期事件，后台线程池更新缓存数据，并重新设置有效时间
		- eg. Google LoadingCache 以上两种方式都有
	- 远端cache，防穿透
		- 远端cache访穿透采用永久缓存数据，每次查询都能查到值.
		- 通过辅助信息判断逻辑过期, 再从远端服务异步拉数据刷新远端cache。


# 参考
5. 移动选购线缓存实践 赵思奇 *** 